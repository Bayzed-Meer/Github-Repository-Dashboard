import{i as G,j as H,k as K,l as W,m as X,n as Y,o as Z,p as ee,q as te}from"./chunk-4YFLKQWQ.js";import{$c as J,Eb as V,Fa as R,Fb as N,Ha as s,Ma as l,Na as u,Oa as g,Pa as A,Qa as M,Ua as F,V as _,Va as k,Wa as I,Xa as y,Yc as B,_c as q,ad as O,ba as b,bb as j,bd as C,ca as x,cb as P,cd as U,db as E,eb as v,fb as S,fd as z,ja as L,l as p,p as d,ua as c,v as w,va as h,wb as $,x as f,xb as Q,zb as T}from"./chunk-DVYQSRTR.js";var oe=["multiselect"],re=()=>({enable:!0});function ne(r,o){if(r&1&&(l(0,"div")(1,"ejs-accumulationchart",7)(2,"e-accumulation-series-collection"),g(3,"e-accumulation-series",8),u()()()),r&2){let ie=o.ngIf;c(),s("tooltip",E(2,re)),c(2),s("dataSource",ie)}}var Se=(()=>{let o=class o{constructor(t,e,i){this.repositoryService=t,this.languageService=e,this.destroyRef=i,this.selectionLimit=3}ngOnInit(){this.fetchLanguages()}fetchLanguages(){this.languages$=this.languageService.fetchLanguages().pipe(d(t=>t.map(e=>e.name)),f(t=>(console.log("Failed to fetch languages..."),p([]))),C(this.destroyRef))}fetchRepositoryCounts(t,e,i,n){let D=t.map(a=>this.repositoryService.fetchRepositories(a,e,i,n).pipe(d(m=>({language:a,count:m.total_count})),f(m=>(console.log("Failed to fetch repositories ..."),p({language:a,count:0}))),C(this.destroyRef)));this.pieChartData$=w(D).pipe(d(a=>a.filter(({count:m})=>m>0)),f(a=>(console.error("Failed to fetch repository counts..."),p([]))))}searchRepositoryCounts(){let t=this.multiselect.value;t&&this.fetchRepositoryCounts(t,"desc",1,1)}};o.\u0275fac=function(e){return new(e||o)(h(z),h(U),h(L))},o.\u0275cmp=_({type:o,selectors:[["app-pie-chart"]],viewQuery:function(e,i){if(e&1&&F(oe,5),e&2){let n;k(n=I())&&(i.multiselect=n.first)}},standalone:!0,features:[j([X,Z,Y,ee,te]),P],decls:11,vars:7,consts:[["multiselect",""],[1,"flex","flex-col","justify-center","items-center","w-3/4","mx-auto","mt-16","gap-4","bg-white","rounded-lg","shadow-lg","p-6"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"flex","gap-4"],["id","multiselectelement","placeholder","Search languages...",1,"w-96",3,"dataSource","maximumSelectionLength"],["type","button","data-cy","search-button",1,"text-white","bg-pink-500","font-semibold","rounded-md","text-sm","px-4","py-2","hover:bg-pink-600","focus:outline-none","focus:ring-2","focus:ring-pink-500",3,"click"],[4,"ngIf"],["id","chart-container",3,"tooltip"],["xName","language","yName","count",3,"dataSource"]],template:function(e,i){if(e&1){let n=A();l(0,"div",1)(1,"h2",2),y(2," Select up to 3 languages to compare their repository counts "),u(),l(3,"div",3),g(4,"ejs-multiselect",4,0),v(6,"async"),l(7,"button",5),M("click",function(){return b(n),x(i.searchRepositoryCounts())}),y(8," Search "),u()(),R(9,ne,4,3,"div",6),v(10,"async"),u()}e&2&&(c(4),s("dataSource",S(6,3,i.languages$))("maximumSelectionLength",i.selectionLimit),c(5),s("ngIf",S(10,5,i.pieChartData$)))},dependencies:[W,K,G,H,q,B,O,J,V,T,$,Q,N],changeDetection:0});let r=o;return r})();export{Se as a};
